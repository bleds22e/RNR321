---
title: "Module 4 Assignment 2"
author: "Ellen Bledsoe"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_document: default
editor_options:
  markdown:
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r warning = FALSE}
library(tidyverse)
```

```{r}
n1 <- 37
n2 <- 42
m2 <- 30
```

4.  

```{r}
N_hat <- n1 * n2 / m2
N_hat
```

5.  

```{r}
p_hat <- m2 / n1
p_hat
```



```{r}
n1_Baileys <- 12
n2_Baileys <- 12
m2_Baileys <- 4
```

7.  

```{r}
N_hat_Baileys <- (n1_Baileys * n2_Baileys) / m2_Baileys
N_hat_Baileys
```

8.  

```{r}
p_hat_Baileys <- m2_Baileys / n1_Baileys
p_hat_Baileys
```


```{r}
N <- 250
```


```{r}
nRuns <- 1000
```


```{r}
LP_estimator <- function(p1, p2, c2) {
  
  # create an empty data frame to hold simulated values
  Nhat <- matrix(NA, nRuns)  # create a matrix to hold estimates
   
  for(i in 1:nRuns) { 
    # simulate data 
    n1 <- rbinom(1, N, p1)     # no. individuals captured on survey occasion 1
    u2 <- rbinom(1, N-n1, p2)  # no. marked individuals recaptured on survey occasion 2
    m2 <- rbinom(1, n1, c2)    # no. marked individuals recaptured on survey occasion 2
    n2 <- u2 + m2              # total no. individuals captured on survey occasion 2
    
    # calculate estimated abundance
    Nhat[i] <- (n1 + 1)*(n2 +1) / (m2 + 1) - 1
  }
  
  return(Nhat) # the function will return our estimate of the population
}
```

**SIMULATED DATA WILL NOT BE EXACT MATCHES**

10.

```{r}
N_hat_high <- LP_estimator(p1 = 0.6, p2 = 0.6, c2 = 0.6)
```

b.  Plot the histogram of this data.

```{r}
hist(N_hat_high)
```

c.  Calculate the bias and precision of the estimate.

```{r}

mean(N_hat_high) - N       


sd(N_hat_high)            
```



11. 

```{r}
N_hat_low <- LP_estimator(p1 = 0.6, p2 = 0.6, c2 = 0.6)
```

b.  Plot the histogram of this data.

```{r}
hist(N_hat_low)
```

c.  Calculate the bias and precision of the estimate.

```{r}

mean(N_hat_low)- N       


sd(N_hat_low)            
```


13. 

```{r}
N_hat_trapshy <- LP_estimator(p1 = 0.4, p2 = 0.4, c2 = 0.2)
```

b.  Plot the histogram of this data.

```{r}
hist(N_hat_trapshy)
```

c.  Calculate the bias and precision of the estimate.

```{r}

mean(N_hat_trapshy)- N      


sd(N_hat_trapshy)          
```



14. 
```{r}
N_hat_traphappy <- LP_estimator(p1 = 0.4, p2 = 0.4, c2 = 0.6)
```

b.  Plot the histogram of this data.

```{r}
hist(N_hat_traphappy)
```

c.  Calculate the bias and precision of the estimate.

```{r}

mean(N_hat_traphappy)- N       


sd(N_hat_traphappy)           
```


```{r}
n1_removal <- n1 # 37
n2_removal <- n2 - m2 # 42 - 30 = 12
```

17. Estimate the abundance of the population.

```{r}
N_hat_removal <- (n1_removal^2) / (n1_removal - n2_removal)
N_hat_removal
```


18. 

```{r}
n1_removalB <- n1_Baileys
n2_removalB <- n2_Baileys - m2_Baileys

N_hat_removalB <- (n1_Baileys^2) / (n1_removalB - n2_removalB)
N_hat_removalB
```
