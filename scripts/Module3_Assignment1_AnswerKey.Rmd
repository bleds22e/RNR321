---
title: "Module 3 Assignment 1"
author: "Ellen Bledsoe"
date: "2023-04-03"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r, message=FALSE}
library(tidyverse)
library(unmarked) 
```


```{r}
tiger <- read_csv("../data_raw/tiger_rattlesnakes.csv")
diamond <- read_csv("../data_raw/diamondback_rattlesnakes.csv")
```
1. 
```{r}
naive_occ_tiger <- tiger %>% 
  mutate(detection = rowSums(.)) %>% 
  summarise(n = n(),
            n_detect = sum(detection > 0)) %>% 
  mutate(naive_occ = n_detect/n)
naive_occ_tiger
```

3.
```{r}
# create the data frame with 40 rows and each column with the survey number
tiger_survey_time <- tibble(.rows = 40,
                            time_1 = "1",
                            time_2 = "2",
                            time_3 = "3",
                            time_4 = "4",
                            time_5 = "5")

# make this into a list of one dataframe
tiger_survey_time <- list(time = tiger_survey_time)
```


4.
```{r}
tigerUMF <- unmarkedFrameOccu(tiger, obsCovs = tiger_survey_time)
head(tigerUMF) # check out the data
```


5.
```{r}
tiger_pdot_psidot <- occu(~1 ~1, data = tigerUMF)
```

6.
```{r}
tiger_ptime_psidot <- occu(~time-1 ~1, data = tigerUMF)
```


7.
```{r}
tiger_models <- fitList(tiger_pdot_psidot  = tiger_pdot_psidot, 
                        tiger_ptime_psidot = tiger_ptime_psidot)
modSel(tiger_models)
```


9.
```{r}
plogis(coef(tiger_pdot_psidot))  # estimates of psi and p
plogis(confint(tiger_pdot_psidot, type = "det", level = 0.95))
```
10.
```{r}
plogis(coef(tiger_pdot_psidot))  # estimates of psi and p
plogis(confint(tiger_pdot_psidot, type = "state", level = 0.95))
```



12. 

```{r}
naive_occ_diamond <- diamond %>% 
  mutate(detection = rowSums(.)) %>% 
  summarise(n = n(),
            n_detect = sum(detection > 0)) %>% 
  mutate(naive_occ = n_detect/n)
naive_occ_diamond
```


13. 

```{r}
# create the data frame with 20 rows and each column with the survey number
diamond_survey_time <- tibble(.rows = 40,
                            time_1 = "1",
                            time_2 = "2",
                            time_3 = "3",
                            time_4 = "4",
                            time_5 = "5")

# make this into a list of one dataframe
diamond_survey_time <- list(time = diamond_survey_time)
```

14. 

```{r}
diamondUMF <- unmarkedFrameOccu(diamond, obsCovs = diamond_survey_time)
head(diamondUMF) # check out the data
```

15. 
```{r}
diamond_pdot_psidot <- occu(~1 ~1, data = diamondUMF)
diamond_ptime_psidot <- occu(~time-1 ~1, data = diamondUMF)
```


16. 

```{r}
diamond_models <- fitList(diamond_pdot_psidot  = diamond_pdot_psidot, 
                          diamond_ptime_psidot = diamond_ptime_psidot)
modSel(diamond_models)
```

17. 

```{r}
plogis(coef(diamond_pdot_psidot))  # estimates of psi and p
plogis(confint(diamond_pdot_psidot, type = "det", level = 0.95))
plogis(confint(diamond_pdot_psidot, type = "state", level = 0.95))
```

